<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Medbed Systems – Patients</title>

    <!-- shared styles -->
    <link rel="stylesheet" href="../shared/variables.css" />
    <link rel="stylesheet" href="../shared/layout.css" />
    <link rel="stylesheet" href="../shared/components.css" />
    <!-- page-specific -->
    <link rel="stylesheet" href="patients.css" />
  </head>

  <body class="dashboard-page">
    <!-- ============= SIDEBAR ============= -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-brand">
          <img src="../images/Med.jpg" alt="Medbed Systems logo" class="brand-logo" />
          <div class="logo-text">
            <span>Medbed Systems</span>
          </div>
        </div>

        <div class="sidebar-user">
          <div class="avatar-circle">JS</div>
          <div class="user-meta">
            <span class="user-name">John Smith</span>
            <span class="user-role">Doctor</span>
          </div>
        </div>
      </div>

      <nav class="sidebar-nav">
        <p class="sidebar-label">Overview</p>
        <a href="../overview/dashboard.html">Dashboard</a>
        <a href="../overview/insights.html">Insights</a>

        <p class="sidebar-label">Operations</p>
        <a href="patients.html" class="active">Patients</a>
        <a href="manage-beds.html">Manage beds</a>
        <a href="manage-rooms.html">Manage rooms</a>
        <a href="users.html">Users</a>

        <a href="../shared/login.html" class="logout-link">Logout</a>
      </nav>
    </aside>

    <!-- ============= MAIN CONTENT ============= -->
    <main class="dashboard-content">
      <header class="topbar">
        <div></div>
        <div class="topbar-pill">
          <span class="pill-label">Today</span>
          <span class="pill-value" id="todayValue">—</span>
        </div>
      </header>

      <section class="page-header">
        <h2>Patients</h2>
        <p class="page-subtitle">
          View current patients, their status, and admission details from the hospital data store.
        </p>
      </section>

      <section class="card patients-card">
        <!-- Filters row -->
        <div class="patients-filters">
          <input
            type="text"
            id="searchInput"
            class="input-text patients-search"
            placeholder="Search by name or MRN"
          />

          <select id="statusFilter" class="input-select">
            <option value="all">All statuses</option>
            <option value="Admitted">Admitted</option>
            <option value="Discharged">Discharged</option>
          </select>

          <select id="reasonFilter" class="input-select">
            <option value="all">All reasons</option>
            <option value="COVID-19">COVID-19</option>
            <option value="Flu">Flu</option>
            <option value="Heart Attack">Heart Attack</option>
          </select>

          <button class="primary-btn" type="button" onclick="applyFilters()">
            Filter
          </button>
        </div>

        <!-- Patients table -->
        <div class="table-wrapper">
          <table class="data-table patients-table">
            <thead>
              <tr>
                <th>Patient</th>
                <th>MRN</th>
                <th>Admission status</th>
                <th>Priority</th>
                <th>Reason</th>
              </tr>
            </thead>
            <tbody id="patientsTableBody">
              <!-- JS will render rows -->
            </tbody>
          </table>
        </div>
      </section>
    </main>

    <!-- ============= PAGE LOGIC ============= -->
    <script>
      const API_BASE = "https://ingest-service-725327609427.us-east5.run.app";

      let ALL_PATIENTS = [];

      function setTodayPatients() {
        const el = document.getElementById("todayValue");
        if (!el) return;
        const now = new Date();
        el.textContent = now.toLocaleString("en-US", {
          month: "short",
          day: "numeric",
        });
      }

      /* ...keep the rest of your existing JS exactly the same... */

      window.addEventListener("load", () => {
        setTodayPatients();
        loadPatients();
      });

      document
        .getElementById("searchInput")
        .addEventListener("keyup", (e) => {
          if (e.key === "Enter") {
            applyFilters();
          }
        });
    </script>
  </body>
</html>
